# IC_ABAW
![image](https://user-images.githubusercontent.com/48800547/158078670-d79283e9-5d9e-4f8b-9962-52bb089459c3.png)
Single task on expression classification with PyTorch.

# Usage
## Requirements
This code is tested with `Ubuntu 16.04` `cuda 10.1`

## Prepare the dataset
Download tha ABAW data from https://ibug.doc.ic.ac.uk/resources/cvpr-2022-3rd-abaw/ to your computer. In this code, all the file paths are written in absolute paths so please remember to redirect the files according to your configuraton.

## Pretrained models
<table>
  <tr>
    <th>Model</th>
    <th>Link</th>
    <th>Citation</th>
  </tr>
  <tr>
    <td>DFEW</td>
    <td>https://dfew-dataset.github.io/</td>
    <td><code itemprop="citation">https://dl.acm.org/doi/10.1145/3394171.3413620</code></td>
  </tr>
  <tr>
    <td>HRNet</td>
    <td>https://github.com/vlad3996/HRNet-landmarks</td>
    <td><code itemprop="citation">https://arxiv.org/pdf/1908.07919.pdf</code></td>
  </tr>
</table>

Go to the `\data` folder and run this code to align the cropped data with the labels.
```shell
python create_table_data.py 
```

## Train your own model
```shell
python main.py \
  --lr=1e-2 \
  --batch_size=64 \
  --net='RNN' \
  --sample='ori' \
  --resume=False
```

## Test the model
```shell
python test.py 
```

# Useful tools
Some useful tools are also provided to analyse the trained network.
Go to the `\tools` folder

`plot_landmark.py` Allows you to print out the landmark generated by HRNet. Three different modes of landmarks are provided.

`plot_tsne.py` Allows you to print out the t-SNE analysis in 2-D view.

`plot_weight.py` Allows you to check the distribution of the dataset.



